apiVersion: "v1"
kind: "Secret"
metadata:
  name: {{ .Release.Name }}-secrets
type: "Opaque"
data:
  MAIL_URL: {{ .Values.botfront.smtpUri | b64enc | quote }}
  MONGO_URL: {{ printf "mongodb://%s:%s@%s:%s/%s?%s" .Values.mongodb.mongodbUsername .Values.mongodb.mongodbPassword .Values.mongodb.mongodbHost .Values.mongodb.mongodbPort .Values.mongodb.mongodbDatabase .Values.mongodb.mongodbQueryString | b64enc | quote }}
  OPLOG_URL: {{ printf "mongodb://%s:%s@%s:%s/%s?%s" .Values.mongodb.mongodbOplogUsername .Values.mongodb.mongodbOplogPassword .Values.mongodb.mongodbHost .Values.mongodb.mongodbPort "local" .Values.mongodb.mongodbQueryString | b64enc | quote }}
  {{ if .Values.botfront.graphQLApiToken -}}
  API_KEY: {{ .Values.botfront.graphQLApiToken | toString | b64enc | quote }}
  {{- end -}}
  {{if .Values.kubernetesApi.baseUrl }}
  K8S_BASE_URL: {{ .Values.kubernetesApi.baseUrl | toString | b64enc | quote }}
  {{end }}
  {{if .Values.kubernetesApi.token }}
  K8S_API_TOKEN: {{ .Values.kubernetesApi.token | toString | b64enc | quote }} 
  {{end }}
